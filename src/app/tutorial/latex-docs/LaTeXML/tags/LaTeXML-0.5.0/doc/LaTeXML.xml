<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC "-//NIST LaTeXML//LaTeXML article" "LaTeXML.dtd">
<?latexml class="article"?>
<?latexml package="latexmldoc"?>
<!-- %**** LaTeXML.tex Line 25 **** -->
<document xmlns="http://dlmf.nist.gov/LaTeXML">
  <title><a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a>: a LaTeX to <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> Converter; 
<emph>Preview Version 0.3.0</emph></title>
  <author>Bruce R. Miller</author>
  <creationdate>March 22, 2006</creationdate>
  <section id="S1" refnum="1">
    <title>Introduction</title>
    <para id="S1.p1">
      <p>For many, LaTeX is the prefered format for document authoring, particularly those
involving significant mathematical content and where quality typesetting is desired.
On the other hand, content-oriented <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> is an extremely useful representation for documents,
<!-- %**** LaTeXML.tex Line 50 **** -->allowing them to be used, and reused, for a variety of purposes, not least,
presentation on the Web. Yet, the style and intent of LaTeX markup, as compared to <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> markup, not to mention its programmability, presents difficulties in converting
documents from the former format to the latter.
Perhaps ironically, these difficulties can be particularly large for mathematical material,
where there is a tendency for the markup to focus on appearance rather than meaning.</p>
    </para>
    <para id="S1.p2">
      <p>The choice of LaTeX for authoring, and <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> for delivery were natural and uncontroversial
choices for the <a href="http://dlmf.nist.gov">Digital Library of Mathematical Functions</a>.
Faced with the need to perform this conversion and the lack of suitable tools to perform it,
the DLMF project proceeded to develop thier own tool, <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a>, for this purpose.
This document describes a <emph>preview</emph> release of <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a>.</p>
    </para>
    <para id="S1.p3">
      <p>The idealistic goals of <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> are:</p>
      <itemize id="I1">
        <item id="I1.1">
          <p>Faithful emulation of TeX's behaviour.</p>
        </item>
        <item id="I1.2">
          <p>Easily extensible.</p>
        </item>
        <item id="I1.3">
          <p>Lossless; preserving both semantic and presentation cues.</p>
        </item>
        <item id="I1.4">
          <p>Uses abstract LaTeX-like, extensible, document type.</p>
        </item>
        <item id="I1.5">
          <p>Determine the semantics of mathematical content
(Content <a href="http://www.w3.org/Math/"><text font="typewriter">MathML</text></a>, <emph>Good</emph> Presentation <a href="http://www.w3.org/Math/"><text font="typewriter">MathML</text></a>, eventually <a href="http://www.openmath.org/"><text font="typewriter">OpenMath</text></a>).</p>
        </item>
      </itemize>
    </para>
    <para id="S1.p4">
      <p>As these goals are not entirely practical, or even somewhat contradictory,
they are implicitly modified by ``as much as possible.''
<!-- %**** LaTeXML.tex Line 75 **** -->Completely mimicing TeX's behaviour would seem to require the sneakiest modifications
to TeX, itself.  `Ease of use' is, of course, in the eye of the beholder.
More significantly, few documents are likely to have completely unambiguous
mathematics markup; human understanding of both the topic and the surrounding
text is needed to properly interpret any particular fragment.
Thus, rather than pretend to provide a `turn-key' solution,
we expect that document-specific declarations or tuning to be necessary
to faithfully convert documents.  Towards this end, we provide a variety
of means to customize the processing and declare the author's intent.
At the same time, especially for new documents, we encourage a more logical,
content-oriented markup style, over a purely presentation-oriented style.</p>
    </para>
    <para id="S1.p5">
      <p>This document continues with an overview of the usage of <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a>(§<ref labelref="sec:usage">2</ref>)
and its architecture (§<ref labelref="sec:architecture">3</ref>).
In §<ref labelref="sec:packages">4</ref>, an overview of customizing <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> is given.
How mathematics is converted to content-oriented forms is discussed in §<ref labelref="sec:math">5</ref>.
Finally, Appendix <ref labelref="app:hierarchy">5</ref> shows an object hierarchy of the system
and Appendix <ref labelref="app:todo">@.2</ref> lists the main problem areas and unfinished features.</p>
    </para>
    <para id="S1.p6">
      <p>In general, for more detail, you should see the perl documentation of various
<a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> Packages (using, for example, the command <text font="typewriter">perldoc LaTeXML</text>),
or the source code itself, and the examples.</p>
    </para>
  </section>
  <section id="S2" refnum="2" label="sec:usage">
    <title>Using <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a></title>
<!-- %**** LaTeXML.tex Line 100 **** -->
    <para id="S2.p1">
      <p>The basic conversion to <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> (using the <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> DTD, by default) is carried out
by the command:</p>
      <quote>
<text font="typewriter">latexml <text font="italic">options</text> document.tex &gt; document.xml</text>
</quote>
      <p>This command reads and processes the TeX document <text font="typewriter">document.tex</text>,
along with any document-specific customization (see §<ref labelref="sec:packages">4</ref>)
in <text font="typewriter">document.latexml</text>, if present,
and constructs an <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> document from it.  The document tree is then subjected to various
rewriting before being passed to the mathematics parser.  The parser applies a grammar based
recursive descent parser to the mathematical content in an attempt to convert
to semantic forms.  (Or, at least to structure consistent with the semantics).</p>
    </para>
    <para id="S2.p2">
      <p>Additional transformations, such as to <a href="http://www.w3.org/HTML/"><text font="typewriter">HTML</text></a>, <a href="http://www.w3.org/Math/"><text font="typewriter">MathML</text></a> or other formats, are carried out
by stylesheets or postprocessing modules in the postprocessor <text font="typewriter">latexmlpost</text>:</p>
      <quote>
<text font="typewriter">latexmlpost <text font="italic">options</text> document.xml</text>
</quote>
    </para>
    <para id="S2.p3">
      <p>See the documentation for the commands <a href="perldoc/latexml.html"><text font="typewriter">latexml</text></a> and <a href="perldoc/latexmlpost.html"><text font="typewriter">latexmlpost</text></a> for details
and description of command options<note class="foot">Use <text font="typewriter">latexml --help</text> or
<text font="typewriter">perldoc latexml</text> to view the documentation</note>.</p>
    </para>
  </section>
  <section id="S3" refnum="3" label="sec:architecture">
    <title>Architectural Overview</title>
    <para id="S3.p1">
      <p>Like TeX, <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> is data-driven: the text and executable control
<!-- %**** LaTeXML.tex Line 125 **** -->sequences (ie. macros and primitives)
in the source file (and any packages loaded) direct the processing.
The user exerts control over the conversion, and customizes it, by
providing alternative <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a>-specific implementations of the control sequences and packages,
by declaring properties of the desired document structure,
and by defining rewrite rules to be applied to the constructed document tree.</p>
    </para>
    <figure id="F1" placement="tb" refnum="1" label="fig:dataflow">
      <graphics graphic="dataflow" options="width=433.62pt"/>
      <caption>Flow of data through <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a>'s digestive tract.</caption>
    </figure>
    <para id="S3.p2">
      <p>The top-level class, <a href="perldoc/LaTeXML.html"><text font="typewriter">LaTeXML</text></a>, manages the processing, providing several methods
for converting a TeX document or string into an <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> document, with varying degrees
of postprocessing and optionally writing the document to file.
A <a href="perldoc/LaTeXML/State.html"><text font="typewriter">LaTeXML::State</text></a> object maintains the current state
of processing, current definitions for control sequences and emulates the
TeX's scoping rules.
The processing is broken into two phases; the TeX-like digestion phase and
the <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> construction phase; See Figure <ref labelref="fig:dataflow">1</ref>.</p>
    </para>
    <para id="S3.p3">
      <p><emph>Digestion</emph> is carried out primarily in a <emph>pull</emph> mode, with the <a href="perldoc/LaTeXML/Stomach.html"><text font="typewriter">LaTeXML::Stomach</text></a> pulling expanded  <a href="perldoc/LaTeXML/Token.html"><text font="typewriter">LaTeXML::Token</text></a>'s from a <a href="perldoc/LaTeXML/Gullet.html"><text font="typewriter">LaTeXML::Gullet</text></a>, which, itself pulls tokens from
a <a href="perldoc/LaTeXML/Mouth.html"><text font="typewriter">LaTeXML::Mouth</text></a>.  The <a href="perldoc/LaTeXML/Mouth.html"><text font="typewriter">LaTeXML::Mouth</text></a> converts characters from the plain text input into tokens according
to the current category codes assigned to them (in the <a href="perldoc/LaTeXML/State.html"><text font="typewriter">LaTeXML::State</text></a>).
The <a href="perldoc/LaTeXML/Gullet.html"><text font="typewriter">LaTeXML::Gullet</text></a> is responsible for expanding any macro or expandible
<!-- %**** LaTeXML.tex Line 150 **** -->tokens (when the current binding of the token in the <a href="perldoc/LaTeXML/State.html"><text font="typewriter">LaTeXML::State</text></a> is an <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Expandable"><text font="typewriter">LaTeXML::Expandable</text></a> definition),
and for parsing sequences of tokens into common core datatypes (numbers, dimensions, etc.).
The <a href="perldoc/LaTeXML/Stomach.html"><text font="typewriter">LaTeXML::Stomach</text></a> digests these tokens by executing <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Primitive"><text font="typewriter">LaTeXML::Primitive</text></a> control
sequences (generally for side effect), converting control sequences bound
to <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Constructor"><text font="typewriter">LaTeXML::Constructor</text></a>'s into <a href="perldoc/LaTeXML/Box.html#LaTeXML/Whatsit"><text font="typewriter">LaTeXML::Whatsit</text></a>'s, and converting the remaining tokens
into a recursive structure of <a href="perldoc/LaTeXML/Box.html#LaTeXML/List"><text font="typewriter">LaTeXML::List</text></a>'s and <a href="perldoc/LaTeXML/Box.html"><text font="typewriter">LaTeXML::Box</text></a>'s.</p>
    </para>
    <para id="S3.p4">
      <p>The main (intentional) deviation of <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a>'s digestion from that of TeX is in the
extension of control sequences to include <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Constructor"><text font="typewriter">LaTeXML::Constructor</text></a>'s responsible for constructing
<a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> document fragments, and <a href="perldoc/LaTeXML/Box.html#LaTeXML/Whatsit"><text font="typewriter">LaTeXML::Whatsit</text></a>'s to represent thier digested form including
whatever arguments were passed to the control sequence.</p>
    </para>
    <para id="S3.p5">
      <p><emph>Construction</emph> of the document thus consists of creating an <a href="perldoc/LaTeXML/Document.html"><text font="typewriter">LaTeXML::Document</text></a>, containing
an <text font="typewriter">XML::LibXML::Document</text> structure, and having it absorb the digested lists, boxes
and whatsits.  Generally, boxes represent text which is converted to text nodes within the
document. Whatsits generally create a document fragment involving elements, attributes
and text.</p>
    </para>
    <para id="S3.p6">
      <p>A <a href="perldoc/LaTeXML/Model.html"><text font="typewriter">LaTeXML::Model</text></a> is maintained througout the digestion phase which accumulates
any document model declarations in particular the document type (currently only
the DTD, but eventually may be RelaxNG based).  As LaTeX markup is more
like <a href="http://www.w3.org/MarkUp/SGML/"><text font="typewriter">HTML</text></a> than <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a>, declarations may be used to indicate which elements may
be automatically opened or closed when needed to build a document tree that matches
the document type.  As an example, a <verbatim font="typewriter">&lt;subsection&gt;</verbatim> will automaticall be closed
when a <verbatim font="typewriter">&lt;section&gt;</verbatim> is begun.
<!-- %**** LaTeXML.tex Line 175 **** --></p>
    </para>
    <para id="S3.p7">
      <p>Once the basic document is constructed, <a href="perldoc/LaTeXML/Rewrite.html"><text font="typewriter">LaTeXML::Rewrite</text></a> rules are applied which can
perform various functions. Ligatures and combining mathematics digits and letters (in certain fonts)
into composite math tokens are handled this way.  Additionally, declarations
of the type or grammatical role of math tokens can be applied here.
Finally, the <a href="perldoc/LaTeXML/MathParser.html"><text font="typewriter">LaTeXML::MathParser</text></a> is invoked which attempts to understand the mathematical
content;  See <ref labelref="sec:math">5</ref> for more details.</p>
    </para>
    <para id="S3.p8">
      <p>The <a href="perldoc/LaTeXML.html"><text font="typewriter">LaTeXML</text></a> object binds <verbatim font="typewriter">$STATE</verbatim>, <verbatim font="typewriter">$GULLET</verbatim>, <verbatim font="typewriter">$STOMACH</verbatim>,
and <verbatim font="typewriter">$MODEL</verbatim> to corresponding active objects during processing.</p>
    </para>
  </section>
  <section id="S4" refnum="4" label="sec:packages">
    <title>Implementation and Customization</title>
    <para id="S4.p1">
      <p>The processsing of the LaTeX document and its  conversion into <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> is affected
by the definitions of control sequences, either as macros, primitives or constructors,
and other declarations specifying the document type, properties of <a href="http://www.w3.org/XML/"><text font="typewriter">XML</text></a> tags, ligatures, ….
These definitions and declarations are typically contained in `packages' which provide
the implementation of LaTeX classes and packages.  For example, the LaTeX directive
<verbatim font="typewriter">\usepackage{foo}</verbatim> would cause <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> to load the file <text font="typewriter">foo.ltxml</text>.
This file would be sought in any of the directories in perl's <verbatim font="typewriter">@INC</verbatim> list (typically
including the current directory), or in a <verbatim font="typewriter">LaTeXML/Package</verbatim> subdirectory of any of
those directories.  If no such file is found, <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> would look for <text font="typewriter">foo.sty</text> and
attempt to process it.</p>
    </para>
    <para id="S4.p2">
      <p>When processing a typical file, say <text font="italic">jobname</text><text font="typewriter">.tex</text>,
the following packages are loaded:
<!-- %**** LaTeXML.tex Line 200 **** --></p>
      <enumerate id="I2">
        <item id="I2.1" refnum="1">
          <p>the core <text font="typewriter">TeX</text> package</p>
        </item>
        <item id="I2.2" refnum="2">
          <p>any packages named with the <verbatim font="typewriter">--preload</verbatim> option,</p>
        </item>
        <item id="I2.3" refnum="3">
          <p>a file <text font="italic">jobname</text><text font="typewriter">.latexml</text>, if present;
this provides for document-specific declarations.</p>
        </item>
      </enumerate>
      <p>Document processing then commences; by default, <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> assumes that the document is plain TeX.
However, if a <verbatim font="typewriter">\documentclass</verbatim> directive is encountered, the <text font="typewriter">LaTeX</text> package, as well
as a package for the named document class are loaded.</p>
    </para>
    <para id="S4.p3">
      <p><a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> implementations are provided for a number of the standard LaTeX packages,
although many implement only part of the functionality.  Contributed implementations are,
of course, welcome.  These files, as well as the document specific <text font="italic">jobname</text><text font="typewriter">.latexml</text>,
are essentially Perl modules, but use the facilities described in <a href="perldoc/LaTeXML/Package.html"><text font="typewriter">LaTeXML::Package</text></a>.</p>
    </para>
  </section>
  <section id="S5" refnum="5" label="sec:math">
    <title>Mathematics</title>
    <para id="S5.p1">
      <p>The mathematical material is parsed into a content-oriented representation following
the usual steps: lexical scanning, grammar-based parsing and (eventually) type-analysis, but
with a few twists. As <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> constructs the initial document, the mathematical material
is converted mainly into a sequence of lexical (mathmematical) tokens (<text font="typewriter">XMTok</text>),
possibly carrying extra information such as name, grammatical role, font, style, etc.
The exceptions are where the mathematical structure is clear from the markup itself,
such as <verbatim font="typewriter">\frac</verbatim> or sub- and superscripts, where a generalized <emph>application</emph> (<text font="typewriter">XMApp</text>)
is constructed.  The substructures will typically play no role in the parsing of the upper
layer of tokens; they are wrapped (in an <text font="typewriter">XMArg</text> or <text font="typewriter">XMWrap</text> element) and parsed
<!-- %**** LaTeXML.tex Line 225 **** -->as separate subexpressions.  At this level, we can think of <a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> as being
a <emph>structure preserving</emph> lexer.</p>
    </para>
    <para id="S5.p2">
      <p>The parser, invoked by the postprocessor, works only with the top-level lists of lexical tokens,
or with those sublists contained in an <text font="typewriter">XMArg</text>.  The grammar works primarily through
the name and grammatical role.  The name is given by an attribute, or the content if it is
the same.  The role (things like ID, FUNCTION, OPERATOR, OPEN, …) is also given
by an attribute, or, if not present, the name is looked up in a document-specific
dictionary (<text font="italic">jobname</text><text font="typewriter">.dict</text>), or in a default dictionary.</p>
    </para>
    <para id="S5.p3">
      <p>Additional exceptions that need fuller explanation are:
(1) <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Constructor"><text font="typewriter">LaTeXML::Constructor</text></a>s may wish to create a dual object (<text font="typewriter">XMDual</text>) whose children are
the semantic and presentational forms.
(2) Spacing and similar markup generates <text font="typewriter">XMHint</text> elements, which are currently ignored
during parsing, but probably shouldn't.</p>
    </para>
  </section>
  <appendix label="app:hierarchy">
    <title>Object Hierarchy</title>
    <para id="p1">
      <description id="I3">
        <item id="I3.1">
          <tag>
            <a href="perldoc/LaTeXML/Object.html">
              <text font="typewriter small">LaTeXML::Object</text>
            </a>
          </tag>
          <p>: Abstract base class.</p>
          <description id="I4">
<!-- %In Token.pm -->
            <item id="I4.1">
              <tag>
                <a href="perldoc/LaTeXML/Token.html">
                  <text font="typewriter small">LaTeXML::Token</text>
                </a>
              </tag>
              <p>: A TeX token: character/string with category code.</p>
            </item>
            <item id="I4.2">
              <tag>
                <a href="perldoc/LaTeXML/Token.html#LaTeXML/Tokens">
                  <text font="typewriter small">LaTeXML::Tokens</text>
                </a>
              </tag>
              <p>: A list of <a href="perldoc/LaTeXML/Token.html"><text font="typewriter small">LaTeXML::Token</text></a>s.
<!-- %**** LaTeXML.tex Line 250 **** --></p>
            </item>
            <item id="I4.3">
              <tag>
                <a href="perldoc/LaTeXML/Token.html#LaTeXML/Number">
                  <text font="typewriter small">LaTeXML::Number</text>
                </a>
              </tag>
              <p>: A TeX number.</p>
              <description id="I5">
                <item id="I5.1">
                  <tag>
                    <a href="perldoc/LaTeXML/Token.html#LaTeXML/Dimension">
                      <text font="typewriter small">LaTeXML::Dimension</text>
                    </a>
                  </tag>
                  <p>: A TeX dimension; number with unit.</p>
                  <description id="I6">
                    <item id="I6.1">
                      <tag>
                        <a href="perldoc/LaTeXML/Token.html#LaTeXML/MuDimension">
                          <text font="typewriter small">LaTeXML::MuDimension</text>
                        </a>
                      </tag>
                      <p>: A TeX math-mode dimension.</p>
                    </item>
                    <item id="I6.2">
                      <tag>
                        <a href="perldoc/LaTeXML/Token.html#LaTeXML/Glue">
                          <text font="typewriter small">LaTeXML::Glue</text>
                        </a>
                      </tag>
                      <p>:  A TeX dimension with shrink and stretch.</p>
                      <description id="I7">
                        <item id="\theenumv@ID">
                          <tag>
                            <a href="perldoc/LaTeXML/Token.html#LaTeXML/MuGlue">
                              <text font="typewriter small">LaTeXML::MuGlue</text>
                            </a>
                          </tag>
                          <p>: A TeX math-mode glue.</p>
                        </item>
                      </description>
                    </item>
                  </description>
                </item>
              </description>
<!-- %In Box.pm -->
            </item>
            <item id="I4.4">
              <tag>
                <a href="perldoc/LaTeXML/Box.html">
                  <text font="typewriter small">LaTeXML::Box</text>
                </a>
              </tag>
              <p>: A digested character/string; base class for digested objects.</p>
              <description id="I8">
                <item id="I8.1">
                  <tag>
                    <a href="perldoc/LaTeXML/Box.html#LaTeXML/MathBox">
                      <text font="typewriter small">LaTeXML::MathBox</text>
                    </a>
                  </tag>
                  <p>: A digested character token in math.</p>
                </item>
                <item id="I8.2">
                  <tag>
                    <a href="perldoc/LaTeXML/Box.html#LaTeXML/Comment">
                      <text font="typewriter small">LaTeXML::Comment</text>
                    </a>
                  </tag>
                  <p>: A digested comment.</p>
                </item>
                <item id="I8.3">
                  <tag>
                    <a href="perldoc/LaTeXML/Box.html#LaTeXML/List">
                      <text font="typewriter small">LaTeXML::List</text>
                    </a>
                  </tag>
                  <p>: A list of text-mode boxes.</p>
                  <description id="I9">
                    <item id="I9.1">
                      <tag>
                        <a href="perldoc/LaTeXML/Box.html#LaTeXML/MathList">
                          <text font="typewriter small">LaTeXML::MathList</text>
                        </a>
                      </tag>
                      <p>: A list of math-mode boxes.</p>
                    </item>
                  </description>
                </item>
                <item id="I8.4">
                  <tag>
                    <a href="perldoc/LaTeXML/Box.html#LaTeXML/Whatsit">
                      <text font="typewriter small">LaTeXML::Whatsit</text>
                    </a>
                  </tag>
                  <p>: A special digested object with arguments and properties; has its own
rules for conversion into an document fragment.</p>
                </item>
              </description>
<!-- %In Font.pm -->
            </item>
            <item id="I4.5">
              <tag>
                <a href="perldoc/LaTeXML/Font.html">
                  <text font="typewriter small">LaTeXML::Font</text>
                </a>
              </tag>
              <p>: A representation of a font, attached to digested objects.
<!-- %**** LaTeXML.tex Line 275 **** --></p>
              <description id="I10">
                <item id="I10.1">
                  <tag>
                    <a href="perldoc/LaTeXML/Font.html#LaTeXML/MathFont">
                      <text font="typewriter small">LaTeXML::MathFont</text>
                    </a>
                  </tag>
                  <p>: A font in math; special rules for merging.</p>
                </item>
              </description>
<!-- %In Node.pm -->
            </item>
            <item id="I4.6">
              <tag>
                <a href="perldoc/LaTeXML/Document.html">
                  <text font="typewriter small">LaTeXML::Document</text>
                </a>
              </tag>
              <p>: A representation of the document under construction.
<!-- %In Definition.pm --></p>
            </item>
            <item id="I4.7">
              <tag>
                <a href="perldoc/LaTeXML/Definition.html">
                  <text font="typewriter small">LaTeXML::Definition</text>
                </a>
              </tag>
              <p>: Represents the action of executable control sequences</p>
              <description id="I11">
                <item id="I11.1">
                  <tag>
                    <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Expandable">
                      <text font="typewriter small">LaTeXML::Expandable</text>
                    </a>
                  </tag>
                  <p>: A definition expandable in the Gullet, (eg. a macro).</p>
                </item>
                <item id="I11.2">
                  <tag>
                    <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Primitive">
                      <text font="typewriter small">LaTeXML::Primitive</text>
                    </a>
                  </tag>
                  <p>: Definition for primitives, carried out in Stomach.</p>
                  <description id="I12">
                    <item id="I12.1">
                      <tag>
                        <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Register">
                          <text font="typewriter small">LaTeXML::Register</text>
                        </a>
                      </tag>
                      <p>: A definition for TeX registers.</p>
                    </item>
                    <item id="I12.2">
                      <tag>
                        <a href="perldoc/LaTeXML/Definition.html#LaTeXML/Constructor">
                          <text font="typewriter small">LaTeXML::Constructor</text>
                        </a>
                      </tag>
                      <p>: A definition that `constructs' document fragments;
generates a Whatsit during digestion.</p>
                    </item>
                  </description>
                </item>
              </description>
<!-- %In Parameters.pm -->
            </item>
            <item id="I4.8">
              <tag>
                <a href="perldoc/LaTeXML/Parameters.html">
                  <text font="typewriter small">LaTeXML::Parameters</text>
                </a>
              </tag>
              <p>: A definition's parameter list; a collection of <a href="perldoc/LaTeXML/Parameter.html#LaTeXML/Parameter"><text font="typewriter small">LaTeXML::Parameter</text></a>s.</p>
            </item>
            <item id="I4.9">
              <tag>
                <a href="perldoc/LaTeXML/Parameter.html#LaTeXML/Parameter">
                  <text font="typewriter small">LaTeXML::Parameter</text>
                </a>
              </tag>
              <p>: A definition's parameter, including type, optional, etc.</p>
            </item>
            <item id="I4.10">
              <tag>
                <a href="perldoc/LaTeXML/Parameter.html#LaTeXML/KeyVals">
                  <text font="typewriter small">LaTeXML::KeyVals</text>
                </a>
              </tag>
              <p>: Representation of LaTeX-style Key-Value lists.
<!-- %In Mouth.pm --></p>
            </item>
            <item id="I4.11">
              <tag>
                <a href="perldoc/LaTeXML/Mouth.html">
                  <text font="typewriter small">LaTeXML::Mouth</text>
                </a>
              </tag>
              <p>: The organ that converts characters (eg. from files) into <a href="perldoc/LaTeXML/Token.html"><text font="typewriter small">LaTeXML::Token</text></a>s.</p>
              <description id="I13">
                <item id="I13.1">
                  <tag>
                    <a href="perldoc/LaTeXML/Mouth.html#LaTeXML/FileMouth">
                      <text font="typewriter small">LaTeXML::FileMouth</text>
                    </a>
                  </tag>
                  <p>: A mouth that tokenizes input from a file.</p>
                  <description id="I14">
<!-- %**** LaTeXML.tex Line 300 **** -->
                    <item id="I14.1">
                      <tag>
                        <a href="perldoc/LaTeXML/Mouth.html#LaTeXML/StyleMouth">
                          <text font="typewriter small">LaTeXML::StyleMouth</text>
                        </a>
                      </tag>
                      <p>: A file mouth for reading style files.</p>
                    </item>
                  </description>
                </item>
                <item id="I13.2">
                  <tag>
                    <a href="perldoc/LaTeXML/Mouth.html#LaTeXML/PerlMouth">
                      <text font="typewriter small">LaTeXML::PerlMouth</text>
                    </a>
                  </tag>
                  <p>: A fake mouth for reading perl modules.</p>
                </item>
              </description>
<!-- %In Gullet.pm -->
            </item>
            <item id="I4.12">
              <tag>
                <a href="perldoc/LaTeXML/Gullet.html">
                  <text font="typewriter small">LaTeXML::Gullet</text>
                </a>
              </tag>
              <p>: The organ that expands <a href="perldoc/LaTeXML/Token.html"><text font="typewriter small">LaTeXML::Token</text></a>s into other sequences of tokens;
also provides common `parsing' operations such as reading numbers, delimited lists of tokens, etc.
<!-- %In Stomach.pm --></p>
            </item>
            <item id="I4.13">
              <tag>
                <a href="perldoc/LaTeXML/Stomach.html">
                  <text font="typewriter small">LaTeXML::Stomach</text>
                </a>
              </tag>
              <p>: The organ that digests <a href="perldoc/LaTeXML/Token.html"><text font="typewriter small">LaTeXML::Token</text></a>s, converting them to a tree of
digested boxes; also contains the current state of grouping, bindings of definitions, etc.
<!-- %In Intestine.pm --></p>
            </item>
            <item id="I4.14">
              <tag>
                <a href="perldoc/LaTeXML/Intestine.html">
                  <text font="typewriter small">LaTeXML::Intestine</text>
                </a>
              </tag>
              <p>: The organ that constructs the document tree from digested boxes.
Vaguely analogous to TeX's output routine, but runs at end of document, rather than per-page.
<!-- %In Model.pm --></p>
            </item>
            <item id="I4.15">
              <tag>
                <a href="perldoc/LaTeXML/Model.html">
                  <text font="typewriter small">LaTeXML::Model</text>
                </a>
              </tag>
              <p>: Represents the model of the document, extracted from the DTD.</p>
            </item>
          </description>
        </item>
      </description>
    </para>
  </appendix>
  <appendix label="app:math">
    <title>Math Details</title>
    <para id="p1">
      <p><a href="http://dlmf.nist.gov/LaTeXML/"><text font="typewriter">LaTeXML</text></a> processes mathematical material by proceeding through several stages:</p>
      <itemize id="I15">
        <item id="I15.1">
          <p>Basic processing of macros, primitives and constructors resulting in
an XML document; the math is primarily represented by a sequence of
tokens (<text font="typewriter">XMTok</text>) or structured items (<text font="typewriter">XMApp</text>, <text font="typewriter">XMDual</text>) and
hints (<text font="typewriter">XMHint</text>, which are ignored).
<!-- %**** LaTeXML.tex Line 325 **** --></p>
        </item>
        <item id="I15.2">
          <p>Document tree rewriting, where rules are applied to modify the document tree.
User supplied rules can be used here to clarify the intent of markup used in the document.</p>
        </item>
        <item id="I15.3">
          <p>Math Parsing; a grammar based parser is applied, depth first, to each level of the math.
In particular, at the top level of each math expression, as well as each
subexpression within structured items (these will have been contained in
an <text font="typewriter">XMArg</text> or <text font="typewriter">XMWrap</text> element).  This results in an expression tree
that will hopefully be an accurate representation of the expression's structure,
but may be ambigous in specifics (eg.`what the meaning of a superscript is).</p>
        </item>
        <item id="I15.4">
          <p><emph>Not yet implemented</emph> a following stage must be developed to resolve
the semantic ambiguities by analyzing and augmenting the expression tree.</p>
        </item>
        <item id="I15.5">
          <p>Target conversion: from the internal <text font="typewriter">XM</text> representation to
<a href="http://www.w3.org/Math/"><text font="typewriter">MathML</text></a> or <a href="http://www.openmath.org/"><text font="typewriter">OpenMath</text></a>.</p>
        </item>
      </itemize>
    </para>
    <para id="p2">
      <p>The <text font="typewriter">Math</text> element is a top-level container for any math mode material; it
serves as the container for the various representations of the math, including
images (through attributes <text font="typewriter">mathimage</text>, <text font="typewriter">width</text> and <text font="typewriter">height</text>),
textual (through attributes <text font="typewriter">tex</text>, <text font="typewriter">content-tex</text> and <text font="typewriter">text</text>),
<a href="http://www.w3.org/Math/"><text font="typewriter">MathML</text></a> and the internal representation itself.
The <text font="typewriter">mode</text> attribute specifies whether the math should be in display or inline mode.</p>
    </para>
    <subsection id="S5.SS1" refnum="@.1" label="app:mathrep">
      <title>Internal Math Resentation</title>
      <para id="S5.SS1.p1">
        <p>The <text font="typewriter">XMath</text> element is the container for the internal representation</p>
      </para>
      <para id="S5.SS1.p2">
        <p>The following attributes can appear on all <text font="typewriter">XM</text> elements:
<!-- %**** LaTeXML.tex Line 350 **** --></p>
        <description id="I16">
          <item id="I16.1">
            <tag>
              <text font="typewriter">role</text>
            </tag>
            <p>the grammatical role that this element plays</p>
          </item>
          <item id="I16.2">
            <tag><text font="typewriter">open</text>, <text font="typewriter">close</text></tag>
            <p>parenthese or delimiters that were used to wrap the
expression represented by this element.</p>
          </item>
          <item id="I16.3">
            <tag><text font="typewriter">argopen</text>, <text font="typewriter">argclose</text>, <text font="typewriter">separators</text></tag>
            <p>delimiters on an function or operator
(the first element of an <text font="typewriter">XMApp</text>)  that were used to delimit the arguments of the function.
The separators is a string of the punctuation characters used to separate arguments.</p>
          </item>
          <item id="I16.4">
            <tag>
              <text font="typewriter">xml:id</text>
            </tag>
            <p>a unique identifier to allow reference (<text font="typewriter">XMRef</text>) to this element.</p>
          </item>
        </description>
      </para>
      <paragraph id="S5.SS1.SSS0.P1">
        <title>Math Tags</title>
        <para id="S5.SS1.SSS0.P1.p1">
          <p>The following tags are used for the intermediate math representation:</p>
          <description id="I17">
            <item id="I17.1">
              <tag>
                <text font="typewriter">XMTok</text>
              </tag>
              <p>represents a math token. It may contain text for presentation.
Additional attributes are:</p>
              <description id="I18">
                <item id="I18.1">
                  <tag>
                    <text font="typewriter">name</text>
                  </tag>
                  <p>the name that represents the `meaning' of the token; this overrides
the content for identifying the token.</p>
                </item>
                <item id="I18.2">
                  <tag>
                    <text font="typewriter">omcd</text>
                  </tag>
                  <p>the <a href="http://www.openmath.org/"><text font="typewriter">OpenMath</text></a> content dictionary that the name belongs to.</p>
                </item>
                <item id="I18.3">
                  <tag>
                    <text font="typewriter">font</text>
                  </tag>
                  <p>the font to be used for presenting the content.</p>
                </item>
                <item id="I18.4">
                  <tag>
                    <text font="typewriter">style</text>
                  </tag>
                  <p>?</p>
                </item>
                <item id="I18.5">
                  <tag>
                    <text font="typewriter">size</text>
                  </tag>
                  <p>?</p>
                </item>
                <item id="I18.6">
                  <tag>
                    <text font="typewriter">stackscripts</text>
                  </tag>
                  <p>whether scripts should be stacked above/below the item, instead
of the usual script position.</p>
                </item>
              </description>
            </item>
            <item id="I17.2">
              <tag>
                <text font="typewriter">XMApp</text>
              </tag>
              <p>represents the generalized application of some function or operator to arguments.
<!-- %**** LaTeXML.tex Line 375 **** -->The first child element is the operator, the remainig elements are the arguments.
Additional attributes:</p>
              <description id="I19">
                <item id="I19.1">
                  <tag>
                    <text font="typewriter">name</text>
                  </tag>
                  <p>the name that represents the meaning of the construct as a whole.</p>
                </item>
                <item id="I19.2">
                  <tag>
                    <text font="typewriter">stackscripts</text>
                  </tag>
                  <p>?</p>
                </item>
              </description>
            </item>
            <item id="I17.3">
              <tag>
                <text font="typewriter">XMDual</text>
              </tag>
              <p>combines representations of the content (the first child) and presentation
(the second child), useful when the two structures are not easily related.</p>
            </item>
            <item id="I17.4">
              <tag>
                <text font="typewriter">XMHint</text>
              </tag>
              <p>represents spacing or other apparent purely presentation material.</p>
              <description id="I20">
                <item id="I20.1">
                  <tag>
                    <text font="typewriter">name</text>
                  </tag>
                  <p>names the effect that the hint was intended to achieve.</p>
                </item>
                <item id="I20.2">
                  <tag>
                    <text font="typewriter">style</text>
                  </tag>
                  <p>?</p>
                </item>
              </description>
            </item>
            <item id="I17.5">
              <tag>
                <text font="typewriter">XMWrap</text>
              </tag>
              <p>serves to assert the expected type or role of a subexpression that
may otherwise be difficult to interpret — the parser is more forgiving about these.</p>
              <description id="I21">
                <item id="I21.1">
                  <tag>
                    <text font="typewriter">name</text>
                  </tag>
                  <p>?</p>
                </item>
                <item id="I21.2">
                  <tag>
                    <text font="typewriter">style</text>
                  </tag>
                  <p>?</p>
                </item>
              </description>
            </item>
            <item id="I17.6">
              <tag>
                <text font="typewriter">XMArg</text>
              </tag>
              <p>serves to wrap individual arguments or subexpressions, created by
structured markup, such as <verbatim font="typewriter">\frac</verbatim>.  These subexpressions can be parsed individually.</p>
              <description id="I22">
                <item id="I22.1">
                  <tag>
                    <text font="typewriter">rule</text>
                  </tag>
                  <p>the grammar rule that this subexpression should match.</p>
                </item>
              </description>
            </item>
            <item id="I17.7">
              <tag>
                <text font="typewriter">XMRef</text>
              </tag>
              <p>refers to another subexpression,.  This is used to avoid duplicating
<!-- %**** LaTeXML.tex Line 400 **** -->arguments when constructing an <text font="typewriter">XMDual</text> to represent a function application, for example.
The arguments will be placed in the content branch (wrapped in an <text font="typewriter">XMArg</text>) while
<text font="typewriter">XMRef</text>'s will be placed in the presentation branch.</p>
              <description id="I23">
                <item id="I23.1">
                  <tag>
                    <text font="typewriter">idref</text>
                  </tag>
                  <p>the identifier of the referenced math subexpression.</p>
                </item>
              </description>
            </item>
          </description>
        </para>
      </paragraph>
    </subsection>
    <subsection id="S5.SS2" refnum="@.2" label="app:mathroles">
      <title>Grammatical Roles</title>
      <para id="S5.SS2.p1">
        <p>The following grammatical roles are recognized by the math parser.
These values can be specified in the <text font="typewriter">role</text> attribute during the initial
document construction or by rewrite rules.  Although the precedence of operators
is loosely described in the following, since the grammar contains various special
case productions, no rigidly ordered precedence is given.</p>
        <description id="I24">
          <item id="I24.1">
            <tag>
              <text font="typewriter">ATOM</text>
            </tag>
            <p>a general atomic subexpression.</p>
          </item>
          <item id="I24.2">
            <tag>
              <text font="typewriter">ID</text>
            </tag>
            <p>a variable-like token, whether scalar or otherwise.</p>
          </item>
          <item id="I24.3">
            <tag>
              <text font="typewriter">PUNCT</text>
            </tag>
            <p>punctuation.</p>
          </item>
          <item id="I24.4">
            <tag>
              <text font="typewriter">APPLYOP</text>
            </tag>
            <p>an explicit infix application operator (high precedence).</p>
          </item>
          <item id="I24.5">
            <tag>
              <text font="typewriter">RELOP</text>
            </tag>
            <p>a relational operator, loosely binding.</p>
          </item>
          <item id="I24.6">
            <tag>
              <text font="typewriter">ARROW</text>
            </tag>
            <p>an arrow operator (with little semantic significance).
treated equivalently to <text font="typewriter">RELOP</text>.</p>
          </item>
          <item id="I24.7">
            <tag>
              <text font="typewriter">METARELOP</text>
            </tag>
            <p>an operator used for relations between relations, with lower precedence.</p>
          </item>
          <item id="I24.8">
            <tag>
              <text font="typewriter">ADDOP</text>
            </tag>
            <p>an addition operator, precedence between relational and multiplicative operators.</p>
          </item>
          <item id="I24.9">
            <tag>
              <text font="typewriter">MULOP</text>
            </tag>
            <p>a multiplicative operator, high precedence.
<!-- %**** LaTeXML.tex Line 425 **** --></p>
          </item>
          <item id="I24.10">
            <tag>
              <text font="typewriter">SUPOP</text>
            </tag>
            <p>An operator appearing in a superscript, such as a collection of primes.</p>
          </item>
          <item id="I24.11">
            <tag>
              <text font="typewriter">OPEN</text>
            </tag>
            <p>an open delimiter.</p>
          </item>
          <item id="I24.12">
            <tag>
              <text font="typewriter">CLOSE</text>
            </tag>
            <p>a close delimiter.</p>
          </item>
          <item id="I24.13">
            <tag>
              <text font="typewriter">MIDDLE</text>
            </tag>
            <p>a middle operator used to group items between an <text font="typewriter">OPEN</text>, <text font="typewriter">CLOSE</text> pair.</p>
          </item>
          <item id="I24.14">
            <tag>
              <text font="typewriter">OPERATOR</text>
            </tag>
            <p>a general operator; higher precedence than function application.
For example, for an operator <Math mode="inline" tex="A" text="A"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok></XMath></Math>, and function <Math mode="inline" tex="F" text="F"><XMath><XMTok role="UNKNOWN" font="italic">F</XMTok></XMath></Math>, <Math mode="inline" tex="AFx" text="A * F * x"><XMath><XMApp><XMTok role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok><XMTok role="UNKNOWN" font="italic">F</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMath></Math> would be interpretted as <Math mode="inline" tex="(A(F))(x)" text="A * F * x"><XMath><XMApp><XMTok role="MULOP">⁢</XMTok><XMApp open="(" close=")"><XMTok role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" possibleFunction="yes" font="italic">A</XMTok><XMTok role="UNKNOWN" open="(" close=")" font="italic">F</XMTok></XMApp><XMTok role="UNKNOWN" open="(" close=")" font="italic">x</XMTok></XMApp></XMath></Math>.</p>
          </item>
          <item id="I24.15">
            <tag>
              <text font="typewriter">SUMOP</text>
            </tag>
            <p>a summation/union operator.</p>
          </item>
          <item id="I24.16">
            <tag>
              <text font="typewriter">INTOP</text>
            </tag>
            <p>an integral operator.</p>
          </item>
          <item id="I24.17">
            <tag>
              <text font="typewriter">LIMITOP</text>
            </tag>
            <p>a limiting operator.</p>
          </item>
          <item id="I24.18">
            <tag>
              <text font="typewriter">DIFFOP</text>
            </tag>
            <p>a differential operator.</p>
          </item>
          <item id="I24.19">
            <tag>
              <text font="typewriter">BIGOP</text>
            </tag>
            <p>a general operator, but lower precedence, such as a <Math mode="inline" tex="P" text="P"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok></XMath></Math> preceding
an integral to denote the principal value.
Note that <text font="typewriter">SUMOP</text>, <text font="typewriter">INTOP</text>, <text font="typewriter">LIMITOP</text>, <text font="typewriter">DIFFOP</text> and <text font="typewriter">BIGOP</text> are treated
equivalently by the grammar, but are distinguished to facilitate (<emph>eventually!</emph>)
analyzing the argument structure (eg bound variables and differentials within an integral).
<text font="bold">Note</text> are <text font="typewriter">SUMOP</text> and <text font="typewriter">LIMITOP</text> significantly different in this sense?</p>
          </item>
          <item id="I24.20">
            <tag>
              <text font="typewriter">VERTBAR</text>
            </tag>
          </item>
          <item id="I24.21">
            <tag>
              <text font="typewriter">FUNCTION</text>
            </tag>
            <p>a function which (may) apply to following arguments with higher
precedence than addition and multiplication, or parenthesized arguments.</p>
          </item>
          <item id="I24.22">
            <tag>
              <text font="typewriter">NUMBER</text>
            </tag>
            <p>a number.</p>
          </item>
          <item id="I24.23">
            <tag>
              <text font="typewriter">POSTSUPERSCRIPT</text>
            </tag>
            <p>the usual superscript, where the script is treated as
an argument, but the base will be determined by parsing. Note that this is not
necessarily assumed to be a power. Very high precedence.</p>
          </item>
          <item id="I24.24">
            <tag>
              <text font="typewriter">POSTSUBSCRIPT</text>
            </tag>
            <p>Similar to <text font="typewriter">POSTSUPERSCRIPT</text> for subscripts.</p>
          </item>
          <item id="I24.25">
            <tag>
              <text font="typewriter">FLOATINGSUPERSCRIPT</text>
            </tag>
            <p>A special case for a superscript on an empty base,
<!-- %**** LaTeXML.tex Line 450 **** -->ie. <verbatim font="typewriter">{}^{x}</verbatim>.  This is often used to place a pre-superscript or for
non-math uses (eg. <verbatim font="typewriter">10${}^{th}</verbatim>).</p>
          </item>
          <item id="I24.26">
            <tag>
              <text font="typewriter">FLOATINGSUBSCRIPT</text>
            </tag>
            <p>Similar to <text font="typewriter">POSTSUPERSCRIPT</text> for subscripts.</p>
          </item>
          <item id="I24.27">
            <tag>
              <text font="typewriter">POSTFIX</text>
            </tag>
            <p>for a postfix operator</p>
          </item>
          <item id="I24.28">
            <tag>
              <text font="typewriter">UNKNOWN</text>
            </tag>
            <p>an unknown expression. This is the default for token elements,
and generates a warning if the unknown seems to be used as a function.</p>
          </item>
        </description>
      </para>
<!-- %Some -->
    </subsection>
  </appendix>
  <appendix label="app:todo">
    <title>Issues and ToDo</title>
    <para id="p1">
      <p>Lots…!</p>
      <itemize id="I25">
        <item id="I25.1">
          <p>Lots of useful LaTeX packages have not been implemented, and those
that are aren't necessarily complete.</p>
        </item>
        <item id="I25.2">
          <p>TeX boxes aren't really complete, and in particular things like <verbatim font="typewriter">\ht0</verbatim>
don't work.</p>
        </item>
        <item id="I25.3">
          <p>Possibly useful to override (pre-override?) a macro defined in the source file;
that is, define it and silently ignore the definition given in the source.</p>
        </item>
        <item id="I25.4">
          <p>…um, …<emph>documentation</emph>!</p>
        </item>
      </itemize>
    </para>
  </appendix>
</document>
